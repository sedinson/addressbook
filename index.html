<!DOCTYPE html>
<html>
  <head>
    <title>Contact Example</title>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
    <link rel="stylesheet" href="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.css">
    <script type="text/javascript" charset="utf-8" src="jquery.min.js"></script>
    <script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>
    <script type="text/javascript" charset="utf-8">

    // Wait for device API libraries to load
    //
    document.addEventListener("deviceready", onDeviceReady, false);

    // device APIs are available
    //
    function onDeviceReady() {
        // specify contact search criteria
        var options = new ContactFindOptions();
        options.filter = "";      // empty search string returns all contacts
        options.multiple = true;  // return multiple results
        filter = ["displayName", "name", "nickname", "phoneNumbers"]; // return contact.displayName field

        // find contacts
        navigator.contacts.find(filter, onSuccess, onError, options);
    }

    // onSuccess: Get a snapshot of the current contacts
    //
    function onSuccess(contacts) {
        for (var i=0; i<contacts.length; i++) {
          if(contacts[i].phoneNumbers) {
            $("#list").html("");
            $("#list").append("<div data-role=\"collapsible\">");
            $("#list").append("<h3>" + contacts[i].displayName + "</h3>");
            $("#list").append("<p>" + contacts[i].name.formatted);
            $("#list").append("<ul>");
            
            for(var j = 0; j < contacts[i].phoneNumbers.length; j++) {
              var phone = contacts[i].phoneNumbers[j];
              $("#list").append("<li><b>" + phone.type + ":</b>" + phone.value + ((phone.pref)? " - [x]" : " - [ ]") + "</li>");
            }
            
            $("#list").append("</ul></p></div>");
          }
        }
        
        $( ".selector" ).collapsibleset( "refresh" );
    };

    // onError: Failed to get the contacts
    //
    function onError(contactError) {
        alert('onError!');
    }

    </script>
  </head>
  <body>
    <div data-role="page" id="page1">
      <div data-role="header">
        <h1>Lista de Contactos</h1>
      </div>
      <div data-role="content">
        <div data-role="collapsible-set" id="list">
          Loading contact information...
        </div>
      </div>
    </div>
    
    <script>
      $(function () {
        $( "#list" ).collapsibleset({ mini: true });
      });
    </script>
  </body>
</html>
